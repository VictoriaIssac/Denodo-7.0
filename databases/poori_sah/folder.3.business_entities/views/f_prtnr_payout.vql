CREATE OR REPLACE VIEW f_prtnr_payout FOLDER = '/3.business_entities' AS SELECT f_prtnr_payout.id_prtnr_payout AS id_prtnr_payout, f_prtnr_payout.id_src_system AS id_src_system, f_prtnr_payout.src_trnsctn_code AS src_trnsctn_code, f_prtnr_payout.id_cntrct AS id_cntrct, f_prtnr_payout.id_applctn AS id_applctn, f_prtnr_payout.id_date_reg AS id_date_reg, f_prtnr_payout.id_time_actual AS id_time_actual, f_prtnr_payout.id_date_actual AS id_date_actual, f_prtnr_payout.id_trnsctn_type AS id_trnsctn_type, f_prtnr_payout.id_src_merchant AS id_src_merchant, f_prtnr_payout.id_merchant_chain AS id_merchant_chain, f_prtnr_payout.sales_amt AS sales_amt, f_prtnr_payout.sales_cnt AS sales_cnt, f_prtnr_payout.cntrct_applctn_code AS cntrct_applctn_code, f_prtnr_payout.cntrct_kid AS cntrct_kid, f_prtnr_payout.cntrct_order_code AS cntrct_order_code, b_cntrct.id_cntrct_origin AS id_cntrct_origin, b_cntrct.id_prt_main_applctn AS id_prt_main_applctn, b_cntrct.id_prt_co_applcnt AS id_prt_co_applcnt, b_cntrct.id_prt_grntr_1 AS id_prt_grntr_1, b_cntrct.id_prt_grntr_2 AS id_prt_grntr_2, b_cntrct.id_prt_grntr_3 AS id_prt_grntr_3, b_cntrct.id_prt_grntr_4 AS id_prt_grntr_4, b_cntrct.id_prt_grntr_5 AS id_prt_grntr_5, b_cntrct.id_sales_channel AS id_sales_channel, b_cntrct.id_merchant AS id_merchant, b_cntrct.id_merchant_res_grntr AS id_merchant_res_grntr, b_cntrct.id_prt_importer AS id_prt_importer, b_cntrct.id_ext_contact_sales_person AS id_ext_contact_sales_person, case WHEN (trnsctn_type_src_code in ('PK', 'PD', 'CJ')) THEN 2441 ELSE b_cntrct.id_prd_agreement END AS id_prd_agreement, b_cntrct.id_cntrct_object AS id_cntrct_object, b_cntrct.id_web_tracking AS id_web_tracking, b_cntrct.id_kam AS id_kam, b_cntrct.id_mvr AS id_mvr, b_cntrct.authority_activated_ind AS authority_activated_ind, b_cntrct.authority_deleted_ind AS authority_deleted_ind, b_cntrct.authority_deleted_datetime AS authority_deleted_datetime, f_prtnr_sttlmnt.id_prtnr_sttlmnt AS id_prtnr_sttlmnt, f_prtnr_sttlmnt.id_date_sttlmnt AS id_date_sttlmnt, f_prtnr_sttlmnt.sttlmnt_trnsctn_unique_ref AS sttlmnt_trnsctn_unique_ref, f_prtnr_sttlmnt.sttlmnt_trnsctn_ref_nmbr AS sttlmnt_trnsctn_ref_nmbr, f_prtnr_sttlmnt.sttlmnt_trnsctn_desc AS sttlmnt_trnsctn_desc, f_prtnr_sttlmnt.sttlmnt_trnsctn_billing_ccy_code AS sttlmnt_trnsctn_billing_ccy_code FROM (((sah.b_prtnr_payout_prtnr_sttlmnt AS b_prtnr_payout_prtnr_sttlmnt RIGHT OUTER JOIN sah.f_prtnr_payout AS f_prtnr_payout ON b_prtnr_payout_prtnr_sttlmnt.id_prtnr_payout = f_prtnr_payout.id_prtnr_payout ) LEFT OUTER JOIN sah.f_prtnr_sttlmnt AS f_prtnr_sttlmnt ON b_prtnr_payout_prtnr_sttlmnt.id_prtnr_sttlmnt = f_prtnr_sttlmnt.id_prtnr_sttlmnt ) LEFT OUTER JOIN sah.b_cntrct AS b_cntrct ON f_prtnr_payout.id_cntrct = b_cntrct.id_cntrct ) LEFT OUTER JOIN d_trnsctn_type AS d_trnsctn_type ON (f_prtnr_payout.id_trnsctn_type = d_trnsctn_type.id_trnsctn_type_src AND d_trnsctn_type.id_src_system = 47)  CONTEXT ('I18N' = 'au_cst');

ALTER VIEW f_prtnr_payout
 LAYOUT (b_prtnr_payout_prtnr_sttlmnt = [440, 330, 370, 126], f_prtnr_payout = [20, 20, 270, 370], f_prtnr_sttlmnt = [950, 270, 200, 225], b_cntrct = [550, 690, 200, 225], d_trnsctn_type = [460, 50, 200, 206]);

